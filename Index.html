<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuizzu French Mode</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --cuizzy-purple: #4b35a0;
            --cuizzy-purple-dark: #3a2980;
            --cuizzy-blue: #0bc2cf;
            --cuizzy-blue-dark: #09a8b3;
            --cuizzy-gold: #ffc107;
            --cuizzy-orange: #ff9800;
            --cuizzy-green: #4caf50;
            --cuizzy-red: #f44336;
            --cuizzy-pink: #e91e63;
            --bg-primary: #f0f2f5;
            --bg-secondary: #ffffff;
            --text-primary: #2d2d2d;
            --text-secondary: #6b7280;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --header-bg: linear-gradient(135deg, #4b35a0 0%, #6c4dc4 100%);
            --input-bg: #ffffff;
            --input-border: #e0e0e0;
        }

        .dark {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.3);
            --input-bg: #1e2a4a;
            --input-border: #3a4a6a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Header */
        .header {
            background: var(--header-bg);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #0bc2cf 0%, #09e8f7 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: 900;
            box-shadow: 0 3px 0 #099aa3;
        }

        .logo-text {
            font-size: 28px;
            font-weight: 900;
            color: white;
            letter-spacing: -1px;
        }

        .nav-buttons {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .nav-btn {
            background: rgba(255,255,255,0.15);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .nav-btn.primary {
            background: var(--cuizzy-blue);
            box-shadow: 0 4px 0 var(--cuizzy-blue-dark);
        }

        .nav-btn.primary:hover {
            background: #0dd5e3;
        }

        .nav-btn.gold {
            background: var(--cuizzy-gold);
            color: #2d2d2d;
            box-shadow: 0 4px 0 #d9a400;
        }

        /* User Profile Button */
        .user-profile-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            border: none;
            color: white;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            transition: all 0.2s;
        }

        .user-profile-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--cuizzy-gold), var(--cuizzy-orange));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 900;
        }

        .user-info {
            text-align: left;
        }

        .user-name {
            font-size: 14px;
            line-height: 1.2;
        }

        .user-points {
            font-size: 11px;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 24px;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #4b35a0 0%, #7c5fd6 50%, #0bc2cf 100%);
            border-radius: 24px;
            padding: 50px 40px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(75, 53, 160, 0.3);
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
        }

        .hero-text h1 {
            font-size: 42px;
            font-weight: 900;
            color: white;
            margin-bottom: 12px;
        }

        .hero-text p {
            font-size: 18px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 24px;
        }

        .hero-buttons {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .hero-btn {
            padding: 16px 32px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hero-btn.join {
            background: var(--cuizzy-blue);
            color: white;
            box-shadow: 0 6px 0 var(--cuizzy-blue-dark);
        }

        .hero-btn.join:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 var(--cuizzy-blue-dark);
        }

        .hero-btn.host {
            background: var(--cuizzy-gold);
            color: #2d2d2d;
            box-shadow: 0 6px 0 #d9a400;
        }

        .hero-btn.host:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #d9a400;
        }

        .hero-btn.solo {
            background: var(--cuizzy-green);
            color: white;
            box-shadow: 0 6px 0 #388e3c;
        }

        .hero-btn.solo:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #388e3c;
        }

        .hero-btn.create {
            background: var(--cuizzy-pink);
            color: white;
            box-shadow: 0 6px 0 #ad1457;
        }

        .hero-btn.create:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #ad1457;
        }

        .hero-mascot {
            font-size: 120px;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2));
        }

        /* Modal Base Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 200;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalPop 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content.large {
            max-width: 800px;
        }

        .modal-content.xlarge {
            max-width: 1000px;
        }

        @keyframes modalPop {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-content h2 {
            font-size: 32px;
            font-weight: 900;
            color: var(--cuizzy-purple);
            margin-bottom: 8px;
        }

        .dark .modal-content h2 {
            color: var(--cuizzy-blue);
        }

        .modal-content p {
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            z-index: 10;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            font-size: 16px;
            font-family: 'Nunito', sans-serif;
            border: 3px solid var(--input-border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--cuizzy-purple);
        }

        .dark .form-input:focus {
            border-color: var(--cuizzy-blue);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .form-divider {
            display: flex;
            align-items: center;
            margin: 24px 0;
            color: var(--text-secondary);
        }

        .form-divider::before,
        .form-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--input-border);
        }

        .form-divider span {
            padding: 0 16px;
            font-weight: 600;
        }

        .form-link {
            color: var(--cuizzy-blue);
            cursor: pointer;
            font-weight: 700;
        }

        .form-link:hover {
            text-decoration: underline;
        }

        /* Join Game Modal */
        .game-id-input {
            width: 100%;
            padding: 18px 24px;
            font-size: 24px;
            font-family: 'Nunito', sans-serif;
            font-weight: 800;
            text-align: center;
            border: 3px solid var(--input-border);
            border-radius: 16px;
            margin-bottom: 20px;
            letter-spacing: 8px;
            transition: border-color 0.2s;
            background: var(--input-bg);
            color: var(--text-primary);
        }

        .game-id-input:focus {
            outline: none;
            border-color: var(--cuizzy-purple);
        }

        .btn-primary {
            width: 100%;
            padding: 16px;
            background: var(--cuizzy-blue);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 5px 0 var(--cuizzy-blue-dark);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 var(--cuizzy-blue-dark);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-gold {
            background: var(--cuizzy-gold);
            color: #2d2d2d;
            box-shadow: 0 5px 0 #d9a400;
        }

        .btn-gold:hover:not(:disabled) {
            box-shadow: 0 7px 0 #d9a400;
        }

        .btn-green {
            background: var(--cuizzy-green);
            box-shadow: 0 5px 0 #388e3c;
        }

        .btn-green:hover:not(:disabled) {
            box-shadow: 0 7px 0 #388e3c;
        }

        .btn-purple {
            background: var(--cuizzy-purple);
            box-shadow: 0 5px 0 var(--cuizzy-purple-dark);
        }

        .btn-purple:hover:not(:disabled) {
            box-shadow: 0 7px 0 var(--cuizzy-purple-dark);
        }

        .btn-pink {
            background: var(--cuizzy-pink);
            box-shadow: 0 5px 0 #ad1457;
        }

        .btn-pink:hover:not(:disabled) {
            box-shadow: 0 7px 0 #ad1457;
        }

        .btn-secondary {
            background: var(--bg-primary);
            color: var(--text-primary);
            box-shadow: 0 5px 0 #d0d0d0;
        }

        .dark .btn-secondary {
            box-shadow: 0 5px 0 #0a0a1a;
        }

        .btn-outline {
            background: transparent;
            border: 3px solid var(--cuizzy-purple);
            color: var(--cuizzy-purple);
            box-shadow: none;
        }

        .dark .btn-outline {
            border-color: var(--cuizzy-blue);
            color: var(--cuizzy-blue);
        }

        .btn-outline:hover {
            background: var(--cuizzy-purple);
            color: white;
        }

        .dark .btn-outline:hover {
            background: var(--cuizzy-blue);
            color: white;
        }

        .btn-sm {
            padding: 10px 16px;
            font-size: 14px;
            box-shadow: 0 3px 0 var(--cuizzy-blue-dark);
        }

        .btn-danger {
            background: var(--cuizzy-red);
            box-shadow: 0 5px 0 #c62828;
        }

        .btn-danger:hover:not(:disabled) {
            box-shadow: 0 7px 0 #c62828;
        }

        /* Question Set Selection */
        .set-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
            text-align: left;
        }

        .set-select-card {
            background: var(--bg-primary);
            border: 3px solid transparent;
            border-radius: 16px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .set-select-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .set-select-card.selected {
            border-color: var(--cuizzy-purple);
            background: rgba(75, 53, 160, 0.1);
        }

        .dark .set-select-card.selected {
            border-color: var(--cuizzy-blue);
            background: rgba(11, 194, 207, 0.1);
        }

        .set-select-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .set-select-info h4 {
            font-size: 14px;
            font-weight: 800;
            margin-bottom: 2px;
        }

        .set-select-info p {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 0;
        }

        /* Create Set Modal */
        .create-set-form {
            text-align: left;
        }

        .questions-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 2px solid var(--input-border);
            border-radius: 12px;
            padding: 12px;
        }

        .question-item {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 10px;
            position: relative;
        }

        .question-item:last-child {
            margin-bottom: 0;
        }

        .question-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .question-item-number {
            font-weight: 800;
            color: var(--cuizzy-purple);
        }

        .dark .question-item-number {
            color: var(--cuizzy-blue);
        }

        .question-item-delete {
            background: var(--cuizzy-red);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .question-item-content {
            font-size: 14px;
        }

        .question-item-content strong {
            color: var(--cuizzy-green);
        }

        .add-question-form {
            background: var(--bg-primary);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .add-question-form h4 {
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .wrong-answers-inputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .emoji-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .emoji-option {
            width: 44px;
            height: 44px;
            border: 2px solid var(--input-border);
            border-radius: 10px;
            background: var(--bg-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emoji-option:hover {
            transform: scale(1.1);
        }

        .emoji-option.selected {
            border-color: var(--cuizzy-purple);
            background: rgba(75, 53, 160, 0.1);
        }

        .dark .emoji-option.selected {
            border-color: var(--cuizzy-blue);
        }

        /* Discover Page */
        .discover-page {
            display: none;
        }

        .discover-page.active {
            display: block;
        }

        .discover-header {
            background: linear-gradient(135deg, #0bc2cf 0%, #4b35a0 100%);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }

        .discover-header h1 {
            font-size: 36px;
            font-weight: 900;
            margin-bottom: 12px;
        }

        .discover-header p {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 24px;
        }

        .search-container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 18px 24px 18px 54px;
            font-size: 18px;
            font-family: 'Nunito', sans-serif;
            border: none;
            border-radius: 16px;
            background: rgba(255,255,255,0.95);
            color: #2d2d2d;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .search-input:focus {
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 20px;
        }

        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .category-chip {
            background: var(--bg-secondary);
            border: 2px solid var(--input-border);
            border-radius: 30px;
            padding: 10px 20px;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-chip:hover {
            border-color: var(--cuizzy-purple);
            transform: translateY(-2px);
        }

        .category-chip.active {
            background: var(--cuizzy-purple);
            border-color: var(--cuizzy-purple);
            color: white;
        }

        .dark .category-chip:hover {
            border-color: var(--cuizzy-blue);
        }

        .dark .category-chip.active {
            background: var(--cuizzy-blue);
            border-color: var(--cuizzy-blue);
        }

        .discover-section {
            margin-bottom: 40px;
        }

        .discover-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .discover-section-title {
            font-size: 24px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .discover-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .discover-card {
            background: var(--bg-secondary);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all 0.2s;
        }

        .discover-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        .discover-card-header {
            padding: 24px;
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .discover-card-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            flex-shrink: 0;
        }

        .discover-card-info h3 {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .discover-card-info .author {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .discover-card-info .description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .discover-card-footer {
            background: var(--bg-primary);
            padding: 14px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .discover-card-stats {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .discover-card-stats span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .discover-card-badge {
            background: var(--cuizzy-green);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
        }

        .discover-card-badge.popular {
            background: var(--cuizzy-gold);
            color: #2d2d2d;
        }

        .discover-card-badge.new {
            background: var(--cuizzy-blue);
        }

        .discover-card-badge.user {
            background: var(--cuizzy-pink);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        /* Game Play Screen */
        .game-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 300;
            overflow-y: auto;
        }

        .game-container.active {
            display: block;
        }

        .game-container.gold-quest {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
        }

        .game-container.battle-royale {
            background: linear-gradient(135deg, #f44336 0%, #c62828 100%);
        }

        .game-container.crypto-hack {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
        }

        .game-container.fishing-frenzy {
            background: linear-gradient(135deg, #2196f3 0%, #0d47a1 100%);
        }

        .game-container.tower-defense {
            background: linear-gradient(135deg, #9c27b0 0%, #6a1b9a 100%);
        }

        .game-container.cafe {
            background: linear-gradient(135deg, #795548 0%, #4e342e 100%);
        }

        .game-container.factory {
            background: linear-gradient(135deg, #607d8b 0%, #37474f 100%);
        }

        .game-container.racing {
            background: linear-gradient(135deg, #e91e63 0%, #ad1457 100%);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
        }

        .game-stats {
            display: flex;
            gap: 20px;
        }

        .game-stat {
            background: rgba(255,255,255,0.2);
            padding: 12px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .game-stat i {
            font-size: 20px;
        }

        .game-stat-value {
            font-size: 24px;
        }

        .game-exit {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .game-exit:hover {
            background: rgba(255,255,255,0.3);
        }

        .game-main {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 30px;
        }

        .question-card {
            background: white;
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .question-number {
            color: var(--cuizzy-purple);
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 28px;
            font-weight: 800;
            color: #2d2d2d;
            margin-bottom: 10px;
        }

        .question-hint {
            font-size: 18px;
            color: #666;
            font-style: italic;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .answer-btn {
            background: white;
            border: 4px solid #e0e0e0;
            border-radius: 16px;
            padding: 24px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 20px;
            font-weight: 800;
            color: #2d2d2d;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .answer-btn:hover:not(.disabled) {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: var(--cuizzy-purple);
        }

        .answer-btn.correct {
            background: var(--cuizzy-green);
            border-color: var(--cuizzy-green);
            color: white;
            animation: correctPulse 0.5s ease;
        }

        .answer-btn.incorrect {
            background: var(--cuizzy-red);
            border-color: var(--cuizzy-red);
            color: white;
            animation: shake 0.5s ease;
        }

        .answer-btn.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .answer-btn.show-correct {
            background: var(--cuizzy-green);
            border-color: var(--cuizzy-green);
            color: white;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .answer-color {
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
        }

        .answer-btn:nth-child(1) .answer-color { background: #f44336; }
        .answer-btn:nth-child(2) .answer-color { background: #2196f3; }
        .answer-btn:nth-child(3) .answer-color { background: #ffc107; }
        .answer-btn:nth-child(4) .answer-color { background: #4caf50; }

        /* Game Over Screen */
        .game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4b35a0 0%, #7c5fd6 50%, #0bc2cf 100%);
            z-index: 400;
            align-items: center;
            justify-content: center;
        }

        .game-over.active {
            display: flex;
        }

        .game-over-content {
            background: white;
            border-radius: 32px;
            padding: 50px 60px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalPop 0.5s ease;
            max-width: 500px;
            width: 90%;
        }

        .game-over-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .game-over-title {
            font-size: 36px;
            font-weight: 900;
            color: var(--cuizzy-purple);
            margin-bottom: 10px;
        }

        .game-over-score {
            font-size: 64px;
            font-weight: 900;
            color: var(--cuizzy-gold);
            margin-bottom: 10px;
        }

        .game-over-detail {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }

        .game-over-buttons {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .game-over-buttons button {
            padding: 16px 32px;
            font-size: 18px;
        }

        /* Streak display */
        .streak-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--cuizzy-gold);
            color: #2d2d2d;
            padding: 20px 40px;
            border-radius: 16px;
            font-size: 32px;
            font-weight: 900;
            z-index: 500;
            display: none;
            animation: streakPop 0.5s ease;
        }

        .streak-display.show {
            display: block;
        }

        @keyframes streakPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title i {
            color: var(--cuizzy-purple);
        }

        .dark .section-title i {
            color: var(--cuizzy-blue);
        }

        .see-all {
            background: none;
            border: none;
            color: var(--cuizzy-blue);
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .see-all:hover {
            text-decoration: underline;
        }

        /* Question Sets */
        .sets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .set-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .set-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .set-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            flex-shrink: 0;
        }

        .set-icon.greetings { background: linear-gradient(135deg, #2196f3, #1976d2); }
        .set-icon.numbers { background: linear-gradient(135deg, #4caf50, #388e3c); }
        .set-icon.colors { background: linear-gradient(135deg, #ff9800, #f57c00); }
        .set-icon.animals { background: linear-gradient(135deg, #e91e63, #c2185b); }
        .set-icon.food { background: linear-gradient(135deg, #00bcd4, #0097a7); }
        .set-icon.family { background: linear-gradient(135deg, #9c27b0, #7b1fa2); }

        .set-info h3 { font-size: 16px; font-weight: 800; margin-bottom: 4px; }
        .set-info p { font-size: 13px; color: var(--text-secondary); margin-bottom: 0; }
        .set-meta { display: flex; gap: 12px; margin-top: 6px; font-size: 12px; color: var(--text-secondary); }
        .set-meta span { display: flex; align-items: center; gap: 4px; }

        /* Footer */
        .footer {
            background: var(--bg-secondary);
            padding: 40px 24px;
            margin-top: 40px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .dark .footer { border-top-color: rgba(255,255,255,0.1); }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .footer-logo { display: flex; align-items: center; gap: 8px; }
        .footer-logo .logo-icon { width: 35px; height: 35px; font-size: 18px; }
        .footer-logo .logo-text { font-size: 22px; color: var(--cuizzy-purple); }
        .dark .footer-logo .logo-text { color: var(--cuizzy-blue); }

        .footer-links { display: flex; gap: 24px; flex-wrap: wrap; }
        .footer-links a { color: var(--text-secondary); text-decoration: none; font-weight: 600; transition: color 0.2s; }
        .footer-links a:hover { color: var(--cuizzy-blue); }

        /* Blooks Showcase */
        .blooks-section { margin-bottom: 50px; }
        .blooks-grid { display: flex; gap: 16px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; }
        .blooks-grid::-webkit-scrollbar { display: none; }

        .blook-card {
            flex-shrink: 0;
            width: 120px;
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 16px;
            text-align: center;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all 0.2s;
        }

        .blook-card:hover { transform: translateY(-5px) scale(1.05); }
        .blook-emoji { font-size: 48px; margin-bottom: 8px; }
        .blook-name { font-size: 12px; font-weight: 700; color: var(--text-primary); }

        .blook-rarity { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-top: 6px; display: inline-block; }
        .blook-rarity.common { background: #e0e0e0; color: #666; }
        .blook-rarity.uncommon { background: #4caf50; color: white; }
        .blook-rarity.rare { background: #2196f3; color: white; }
        .blook-rarity.epic { background: #9c27b0; color: white; }
        .blook-rarity.legendary { background: linear-gradient(135deg, #ffc107, #ff9800); color: #2d2d2d; }
        .blook-rarity.chroma { background: linear-gradient(135deg, #ff0080, #7928ca, #0bc2cf); color: white; }
        .blook-rarity.unique { background: linear-gradient(135deg, #4e1cd768, #7928ca, #3b19c6); color: rgb(6, 240, 220); }

        /* User Profile Modal */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            text-align: left;
        }

        .profile-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--cuizzy-gold), var(--cuizzy-orange));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: 900;
            color: white;
        }

        .profile-details h3 {
            font-size: 24px;
            font-weight: 800;
        }

        .profile-details p {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 0;
        }

        .profile-stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .profile-stat-card {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
        }

        .profile-stat-value {
            font-size: 32px;
            font-weight: 900;
            color: var(--cuizzy-purple);
        }

        .dark .profile-stat-value {
            color: var(--cuizzy-blue);
        }

        .profile-stat-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header { padding: 10px 16px; }
            .logo-text { font-size: 22px; }
            .nav-btn { padding: 8px 14px; font-size: 14px; }
            .nav-btn span { display: none; }
            .hero { padding: 30px 24px; }
            .hero-text h1 { font-size: 28px; }
            .hero-text p { font-size: 16px; }
            .hero-btn { padding: 14px 24px; font-size: 16px; }
            .hero-mascot { font-size: 80px; }
            .section-title { font-size: 22px; }
            .sets-grid { grid-template-columns: 1fr; }
            .footer-content { flex-direction: column; text-align: center; }
            .footer-links { justify-content: center; }
            .modal-content { padding: 30px 20px; }
            .modal-content h2 { font-size: 26px; }
            .set-selection-grid { grid-template-columns: 1fr; }
            .answers-grid { grid-template-columns: 1fr; }
            .question-text { font-size: 22px; }
            .answer-btn { padding: 18px 16px; font-size: 18px; }
            .game-stats { flex-wrap: wrap; gap: 10px; }
            .game-stat { padding: 8px 16px; }
            .game-stat-value { font-size: 18px; }
            .user-info { display: none; }
            .form-row { grid-template-columns: 1fr; }
            .wrong-answers-inputs { grid-template-columns: 1fr; }
            .discover-grid { grid-template-columns: 1fr; }
            .profile-stats-grid { grid-template-columns: 1fr; }
            .category-filters { gap: 8px; }
            .category-chip { padding: 8px 14px; font-size: 12px; }
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .hero-mascot { animation: float 3s ease-in-out infinite; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--cuizzy-purple);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 700;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
            opacity: 0;
            transition: all 0.3s;
            z-index: 600;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

        .btn-row { display: flex; gap: 12px; margin-top: 20px; }
        .btn-row button { flex: 1; }

        /* Progress bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 2px solid var(--input-border);
            padding-bottom: 8px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 10px 20px;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 15px;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            transition: all 0.2s;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-primary);
        }

        .tab-btn.active {
            color: var(--cuizzy-purple);
            border-bottom: 3px solid var(--cuizzy-purple);
            margin-bottom: -10px;
        }

        .dark .tab-btn.active {
            color: var(--cuizzy-blue);
            border-bottom-color: var(--cuizzy-blue);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Password strength */
        .password-strength {
            height: 4px;
            background: var(--input-border);
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }

        .password-strength-fill {
            height: 100%;
            transition: all 0.3s;
            border-radius: 2px;
        }

        .password-strength-fill.weak { width: 33%; background: var(--cuizzy-red); }
        .password-strength-fill.medium { width: 66%; background: var(--cuizzy-orange); }
        .password-strength-fill.strong { width: 100%; background: var(--cuizzy-green); }

        /* My Sets Section */
        .my-sets-empty {
            background: var(--bg-primary);
            border: 3px dashed var(--input-border);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
        }

        .my-sets-empty i {
            font-size: 48px;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .my-sets-empty h3 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .my-sets-empty p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo" onclick="goHome()">
            <div class="logo-icon">C</div>
            <span class="logo-text">Cuizzy</span>
        </div>
        <nav class="nav-buttons" id="navButtons">
            <button class="nav-btn" onclick="showDiscover()">
                <i class="fas fa-compass"></i>
                <span>Discover</span>
            </button>
            <button class="nav-btn gold" onclick="openCreateSetModal()">
                <i class="fas fa-plus"></i>
                <span>Create</span>
            </button>
            <!-- Auth buttons (shown when logged out) -->
            <div id="authButtons">
                <button class="nav-btn primary" onclick="openAuthModal('login')">
                    <i class="fas fa-user"></i>
                    <span>Log In</span>
                </button>
            </div>
            <!-- User profile (shown when logged in) -->
            <button class="user-profile-btn" id="userProfileBtn" style="display: none;" onclick="openProfileModal()">
                <div class="user-avatar" id="userAvatarNav">J</div>
                <div class="user-info">
                    <div class="user-name" id="userNameNav">John</div>
                    <div class="user-points"><i class="fas fa-coins"></i> <span id="userPointsNav">0</span></div>
                </div>
            </button>
        </nav>
    </header>

    <!-- Main Content (Home) -->
    <main class="main-content" id="mainContent">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-content">
                <div class="hero-text">
                    <h1>Apprenez le Fran√ßais! üá´üá∑</h1>
                    <p>Practice French with fun games. Create sets, play solo, or host for friends!</p>
                    <div class="hero-buttons">
                        <button class="hero-btn solo" onclick="openSoloModal()">
                            <i class="fas fa-user"></i>
                            Solo Practice
                        </button>
                        <button class="hero-btn create" onclick="openCreateSetModal()">
                            <i class="fas fa-plus-circle"></i>
                            Create Set
                        </button>
                        <button class="hero-btn join" onclick="openJoinModal()">
                            <i class="fas fa-gamepad"></i>
                            Join Game
                        </button>
                    </div>
                </div>
                <div class="hero-mascot">ü•ê</div>
            </div>
        </section>

        <!-- My Sets Section (shown when logged in) -->
        <section id="mySetsSection" style="display: none; margin-bottom: 40px;">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-folder"></i>
                    My Question Sets
                </h2>
            </div>
            <div id="mySetsGrid" class="sets-grid">
                <!-- User created sets will appear here -->
            </div>
        </section>

        <!-- French Question Sets -->
        <section>
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-book"></i>
                    French Question Sets
                </h2>
                <button class="see-all" onclick="showDiscover()">See All <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="sets-grid" id="questionSetsGrid">
                <!-- Sets loaded dynamically -->
            </div>
        </section>

        <!-- Blooks Showcase -->
        <section class="blooks-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-star"></i>
                    Collect Cuizzys
                </h2>
            </div>
            <div class="blooks-grid">
                <div class="blook-card"><div class="blook-emoji">üê±</div><div class="blook-name">Chat</div><span class="blook-rarity common">Common</span></div>
                <div class="blook-card"><div class="blook-emoji">üê∂</div><div class="blook-name">Chien</div><span class="blook-rarity common">Common</span></div>
                <div class="blook-card"><div class="blook-emoji">ü¶ä</div><div class="blook-name">Renard</div><span class="blook-rarity uncommon">Uncommon</span></div>
                <div class="blook-card"><div class="blook-emoji">ü¶Å</div><div class="blook-name">Lion</div><span class="blook-rarity rare">Rare</span></div>
                <div class="blook-card"><div class="blook-emoji">üêâ</div><div class="blook-name">Dragon</div><span class="blook-rarity epic">Epic</span></div>
                <div class="blook-card"><div class="blook-emoji">ü¶Ñ</div><div class="blook-name">Licorne</div><span class="blook-rarity legendary">Legendary</span></div>
                <div class="blook-card"><div class="blook-emoji">ü•ê</div><div class="blook-name">Croissant</div><span class="blook-rarity chroma">Chroma</span></div>
                <div class="blook-card"><div class="blook-emoji">üóº</div><div class="blook-name">Tour Eiffel</div><span class="blook-rarity unique">Unique</span></div>
            </div>
        </section>
    </main>

    <!-- Discover Page -->
    <div class="main-content discover-page" id="discoverPage">
        <div class="discover-header">
            <h1><i class="fas fa-compass"></i> Discover Sets</h1>
            <p>Explore French question sets created by the community</p>
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="discoverSearch" placeholder="Search for sets..." oninput="filterDiscoverSets()">
            </div>
        </div>

        <div class="category-filters" id="categoryFilters">
            <button class="category-chip active" onclick="filterByCategory(this, 'all')">üåü All</button>
            <button class="category-chip" onclick="filterByCategory(this, 'greetings')">üëã Greetings</button>
            <button class="category-chip" onclick="filterByCategory(this, 'numbers')">üî¢ Numbers</button>
            <button class="category-chip" onclick="filterByCategory(this, 'colors')">üé® Colors</button>
            <button class="category-chip" onclick="filterByCategory(this, 'animals')">üêæ Animals</button>
            <button class="category-chip" onclick="filterByCategory(this, 'food')">üçΩÔ∏è Food</button>
            <button class="category-chip" onclick="filterByCategory(this, 'family')">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</button>
            <button class="category-chip" onclick="filterByCategory(this, 'custom')">‚ú® Community</button>
        </div>

        <section class="discover-section">
            <div class="discover-section-header">
                <h2 class="discover-section-title"><i class="fas fa-fire" style="color: var(--cuizzy-orange);"></i> Popular Sets</h2>
            </div>
            <div class="discover-grid" id="discoverGrid">
                <!-- Cards loaded dynamically -->
            </div>
        </section>

        <button class="btn-primary btn-secondary" onclick="goHome()" style="max-width: 200px; margin: 20px auto;">
            <i class="fas fa-arrow-left"></i> Back to Home
        </button>
    </div>

    <!-- Footer -->
    <footer class="footer" id="mainFooter">
        <div class="footer-content">
            <div class="footer-logo">
                <div class="logo-icon">C</div>
                <span class="logo-text">Cuizzy</span>
            </div>
            <nav class="footer-links">
                <a href="#">About</a>
                <a href="#">Help</a>
                <a href="#">Privacy</a>
                <a href="#">Terms</a>
            </nav>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('authModal')"><i class="fas fa-times"></i></button>

            <div class="tabs">
                <button class="tab-btn active" id="loginTab" onclick="switchAuthTab('login')">Log In</button>
                <button class="tab-btn" id="signupTab" onclick="switchAuthTab('signup')">Sign Up</button>
            </div>

            <!-- Login Form -->
            <div class="tab-content active" id="loginContent">
                <div class="form-group">
                    <label>Email or Username</label>
                    <input type="text" class="form-input" id="loginEmail" placeholder="Enter email or username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn-primary btn-purple" onclick="handleLogin()">
                    <i class="fas fa-sign-in-alt"></i> Log In
                </button>
                <p style="margin-top: 20px; font-size: 14px;">
                    Don't have an account? <span class="form-link" onclick="switchAuthTab('signup')">Sign up</span>
                </p>
            </div>

            <!-- Signup Form -->
            <div class="tab-content" id="signupContent">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" class="form-input" id="signupUsername" placeholder="Choose a username" oninput="validateSignupForm()">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-input" id="signupEmail" placeholder="Enter your email" oninput="validateSignupForm()">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-input" id="signupPassword" placeholder="Create a password" oninput="checkPasswordStrength(); validateSignupForm()">
                    <div class="password-strength">
                        <div class="password-strength-fill" id="passwordStrength"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" class="form-input" id="signupConfirmPassword" placeholder="Confirm your password" oninput="validateSignupForm()">
                </div>
                <button class="btn-primary btn-green" id="signupBtn" onclick="handleSignup()" disabled>
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                <p style="margin-top: 20px; font-size: 14px;">
                    Already have an account? <span class="form-link" onclick="switchAuthTab('login')">Log in</span>
                </p>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('profileModal')"><i class="fas fa-times"></i></button>

            <div class="profile-header">
                <div class="profile-avatar-large" id="profileAvatar">J</div>
                <div class="profile-details">
                    <h3 id="profileName">John</h3>
                    <p id="profileEmail">john@example.com</p>
                </div>
            </div>

            <div class="profile-stats-grid">
                <div class="profile-stat-card">
                    <div class="profile-stat-value" id="profilePoints">0</div>
                    <div class="profile-stat-label">Total Points</div>
                </div>
                <div class="profile-stat-card">
                    <div class="profile-stat-value" id="profileGames">0</div>
                    <div class="profile-stat-label">Games Played</div>
                </div>
                <div class="profile-stat-card">
                    <div class="profile-stat-value" id="profileSets">0</div>
                    <div class="profile-stat-label">Sets Created</div>
                </div>
            </div>

            <div class="btn-row">
                <button class="btn-primary btn-secondary" onclick="closeModal('profileModal')">
                    <i class="fas fa-times"></i> Close
                </button>
                <button class="btn-primary btn-danger" onclick="handleLogout()">
                    <i class="fas fa-sign-out-alt"></i> Log Out
                </button>
            </div>
        </div>
    </div>

    <!-- Join Game Modal -->
    <div class="modal" id="joinModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('joinModal')"><i class="fas fa-times"></i></button>
            <h2>Join a Game</h2>
            <p>Enter the Game ID provided by your host</p>
            <input type="text" class="game-id-input" id="gameIdInput" placeholder="000000" maxlength="6" inputmode="numeric">
            <button class="btn-primary" onclick="submitGameId()">Join Game</button>
        </div>
    </div>

    <!-- Solo Practice Modal -->
    <div class="modal" id="soloModal">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('soloModal')"><i class="fas fa-times"></i></button>
            <h2>üá´üá∑ Solo Practice</h2>
            <p>Choose a French topic to practice</p>

            <div class="set-selection-grid" id="soloSetGrid">
                <!-- Sets loaded dynamically -->
            </div>

            <button class="btn-primary btn-green" onclick="startSoloFromModal()" id="startSoloBtn" disabled>
                <i class="fas fa-play"></i> Start Practice
            </button>
        </div>
    </div>

    <!-- Create Set Modal -->
    <div class="modal" id="createSetModal">
        <div class="modal-content xlarge">
            <button class="modal-close" onclick="closeModal('createSetModal')"><i class="fas fa-times"></i></button>
            <h2>‚ú® Create Question Set</h2>
            <p>Build your own French vocabulary set</p>

            <div class="create-set-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Set Name</label>
                        <input type="text" class="form-input" id="setName" placeholder="e.g., Days of the Week">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select class="form-input" id="setCategory">
                            <option value="greetings">üëã Greetings</option>
                            <option value="numbers">üî¢ Numbers</option>
                            <option value="colors">üé® Colors</option>
                            <option value="animals">üêæ Animals</option>
                            <option value="food">üçΩÔ∏è Food</option>
                            <option value="family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</option>
                            <option value="custom">‚ú® Custom</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Set Icon</label>
                    <div class="emoji-picker" id="emojiPicker">
                        <button type="button" class="emoji-option selected" onclick="selectEmoji(this, 'üìö')">üìö</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üéØ')">üéØ</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üåü')">üåü</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üé®')">üé®</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üî¢')">üî¢</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üéµ')">üéµ</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üè†')">üè†</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üåç')">üåç</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üé≠')">üé≠</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üìÖ')">üìÖ</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üíº')">üíº</button>
                        <button type="button" class="emoji-option" onclick="selectEmoji(this, 'üéì')">üéì</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Questions (<span id="questionCount">0</span>/20)</label>
                    <div class="questions-list" id="questionsList">
                        <div class="empty-state" style="padding: 30px;">
                            <i class="fas fa-clipboard-list"></i>
                            <p style="margin-bottom: 0;">No questions added yet. Add your first question below!</p>
                        </div>
                    </div>
                </div>

                <div class="add-question-form">
                    <h4><i class="fas fa-plus-circle"></i> Add Question</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>English Word/Phrase</label>
                            <input type="text" class="form-input" id="newQuestionText" placeholder="e.g., Monday">
                        </div>
                        <div class="form-group">
                            <label>French Translation (Correct Answer)</label>
                            <input type="text" class="form-input" id="newCorrectAnswer" placeholder="e.g., Lundi">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Wrong Answers (3 required)</label>
                        <div class="wrong-answers-inputs">
                            <input type="text" class="form-input" id="wrongAnswer1" placeholder="Wrong answer 1">
                            <input type="text" class="form-input" id="wrongAnswer2" placeholder="Wrong answer 2">
                            <input type="text" class="form-input" id="wrongAnswer3" placeholder="Wrong answer 3">
                        </div>
                    </div>
                    <button class="btn-primary btn-sm" onclick="addQuestionToSet()" style="width: auto;">
                        <i class="fas fa-plus"></i> Add Question
                    </button>
                </div>

                <div class="btn-row">
                    <button class="btn-primary btn-secondary" onclick="closeModal('createSetModal')">
                        Cancel
                    </button>
                    <button class="btn-primary btn-pink" id="saveSetBtn" onclick="saveQuestionSet()" disabled>
                        <i class="fas fa-save"></i> Save Set
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Play Screen -->
    <div class="game-container" id="gameContainer">
        <div class="game-header">
            <div class="game-stats">
                <div class="game-stat">
                    <i class="fas fa-coins"></i>
                    <span class="game-stat-value" id="scoreDisplay">0</span>
                </div>
                <div class="game-stat">
                    <i class="fas fa-fire"></i>
                    <span class="game-stat-value" id="streakDisplay">0</span>
                </div>
                <div class="game-stat">
                    <i class="fas fa-check-circle"></i>
                    <span class="game-stat-value" id="correctDisplay">0/10</span>
                </div>
            </div>
            <button class="game-exit" onclick="exitGame()">
                <i class="fas fa-sign-out-alt"></i> Exit
            </button>
        </div>

        <div class="game-main">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <div class="question-card">
                <div class="question-number" id="questionNumber">Question 1 of 10</div>
                <div class="question-text" id="questionText">What is "Hello" in French?</div>
                <div class="question-hint" id="questionHint">(English ‚Üí French)</div>
            </div>

            <div class="answers-grid" id="answersGrid">
                <button class="answer-btn"><span class="answer-color"></span>Bonjour</button>
                <button class="answer-btn"><span class="answer-color"></span>Merci</button>
                <button class="answer-btn"><span class="answer-color"></span>Au revoir</button>
                <button class="answer-btn"><span class="answer-color"></span>Oui</button>
            </div>
        </div>
    </div>

    <!-- Game Over Screen -->
    <div class="game-over" id="gameOver">
        <div class="game-over-content">
            <div class="game-over-icon" id="gameOverIcon">üèÜ</div>
            <div class="game-over-title">Fantastique!</div>
            <div class="game-over-score" id="finalScore">850</div>
            <div class="game-over-detail" id="gameOverDetail">You got 8/10 correct!</div>
            <div class="game-over-buttons">
                <button class="btn-primary btn-secondary" onclick="goHome()">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="btn-primary btn-green" onclick="playAgain()">
                    <i class="fas fa-redo"></i> Play Again
                </button>
            </div>
        </div>
    </div>

    <!-- Streak Popup -->
    <div class="streak-display" id="streakPopup">üî• 3 Streak!</div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            document.documentElement.classList.toggle('dark', event.matches);
        });

        // ==================== DATA STORE ====================
        // User data (simulating database)
        const userStore = {
            users: [],
            currentUser: null
        };

        // French Question Sets (built-in)
        const builtInSets = {
            greetings: {
                name: 'Greetings & Phrases',
                icon: 'üëã',
                category: 'greetings',
                author: 'Cuizzy',
                plays: 1250,
                questions: [
                    { q: "Hello", a: "Bonjour", wrong: ["Merci", "Au revoir", "Oui"] },
                    { q: "Goodbye", a: "Au revoir", wrong: ["Bonjour", "Merci", "S'il vous pla√Æt"] },
                    { q: "Thank you", a: "Merci", wrong: ["S'il vous pla√Æt", "Pardon", "Bonjour"] },
                    { q: "Please", a: "S'il vous pla√Æt", wrong: ["Merci", "Pardon", "De rien"] },
                    { q: "Yes", a: "Oui", wrong: ["Non", "Peut-√™tre", "Merci"] },
                    { q: "No", a: "Non", wrong: ["Oui", "Peut-√™tre", "Pardon"] },
                    { q: "Excuse me", a: "Excusez-moi", wrong: ["Pardon", "Merci", "Bonjour"] },
                    { q: "Good night", a: "Bonne nuit", wrong: ["Bon matin", "Bonsoir", "Bonjour"] },
                    { q: "Good evening", a: "Bonsoir", wrong: ["Bonjour", "Bonne nuit", "Bon apr√®s-midi"] },
                    { q: "How are you?", a: "Comment allez-vous?", wrong: ["O√π √™tes-vous?", "Qui √™tes-vous?", "Que faites-vous?"] }
                ]
            },
            numbers: {
                name: 'Numbers 1-20',
                icon: 'üî¢',
                category: 'numbers',
                author: 'Cuizzy',
                plays: 980,
                questions: [
                    { q: "One", a: "Un", wrong: ["Deux", "Trois", "Quatre"] },
                    { q: "Two", a: "Deux", wrong: ["Un", "Trois", "Cinq"] },
                    { q: "Three", a: "Trois", wrong: ["Deux", "Quatre", "Cinq"] },
                    { q: "Five", a: "Cinq", wrong: ["Quatre", "Six", "Sept"] },
                    { q: "Ten", a: "Dix", wrong: ["Neuf", "Onze", "Douze"] },
                    { q: "Twelve", a: "Douze", wrong: ["Onze", "Treize", "Quatorze"] },
                    { q: "Fifteen", a: "Quinze", wrong: ["Quatorze", "Seize", "Dix-sept"] },
                    { q: "Seventeen", a: "Dix-sept", wrong: ["Seize", "Dix-huit", "Quinze"] },
                    { q: "Twenty", a: "Vingt", wrong: ["Dix-neuf", "Dix-huit", "Trente"] },
                    { q: "Zero", a: "Z√©ro", wrong: ["Un", "Dix", "Cent"] }
                ]
            },
            colors: {
                name: 'Colors',
                icon: 'üé®',
                category: 'colors',
                author: 'Cuizzy',
                plays: 1100,
                questions: [
                    { q: "Red", a: "Rouge", wrong: ["Bleu", "Vert", "Jaune"] },
                    { q: "Blue", a: "Bleu", wrong: ["Rouge", "Vert", "Violet"] },
                    { q: "Green", a: "Vert", wrong: ["Bleu", "Jaune", "Rouge"] },
                    { q: "Yellow", a: "Jaune", wrong: ["Orange", "Vert", "Rouge"] },
                    { q: "Black", a: "Noir", wrong: ["Blanc", "Gris", "Marron"] },
                    { q: "White", a: "Blanc", wrong: ["Noir", "Gris", "Beige"] },
                    { q: "Orange", a: "Orange", wrong: ["Jaune", "Rouge", "Marron"] },
                    { q: "Pink", a: "Rose", wrong: ["Rouge", "Violet", "Blanc"] },
                    { q: "Purple", a: "Violet", wrong: ["Bleu", "Rose", "Rouge"] },
                    { q: "Brown", a: "Marron", wrong: ["Orange", "Noir", "Gris"] }
                ]
            },
            animals: {
                name: 'Animals',
                icon: 'üêæ',
                category: 'animals',
                author: 'Cuizzy',
                plays: 890,
                questions: [
                    { q: "Cat", a: "Chat", wrong: ["Chien", "Oiseau", "Souris"] },
                    { q: "Dog", a: "Chien", wrong: ["Chat", "Loup", "Renard"] },
                    { q: "Bird", a: "Oiseau", wrong: ["Poisson", "Papillon", "Abeille"] },
                    { q: "Fish", a: "Poisson", wrong: ["Oiseau", "Tortue", "Crabe"] },
                    { q: "Horse", a: "Cheval", wrong: ["Vache", "Mouton", "Cochon"] },
                    { q: "Cow", a: "Vache", wrong: ["Cheval", "Taureau", "Mouton"] },
                    { q: "Rabbit", a: "Lapin", wrong: ["Souris", "√âcureuil", "Hamster"] },
                    { q: "Lion", a: "Lion", wrong: ["Tigre", "L√©opard", "Gu√©pard"] },
                    { q: "Elephant", a: "√âl√©phant", wrong: ["Girafe", "Hippopotame", "Rhinoc√©ros"] },
                    { q: "Butterfly", a: "Papillon", wrong: ["Abeille", "Mouche", "Coccinelle"] }
                ]
            },
            food: {
                name: 'Food & Drinks',
                icon: 'üçΩÔ∏è',
                category: 'food',
                author: 'Cuizzy',
                plays: 760,
                questions: [
                    { q: "Bread", a: "Pain", wrong: ["Fromage", "Beurre", "Lait"] },
                    { q: "Cheese", a: "Fromage", wrong: ["Pain", "Beurre", "Jambon"] },
                    { q: "Water", a: "Eau", wrong: ["Lait", "Jus", "Vin"] },
                    { q: "Milk", a: "Lait", wrong: ["Eau", "Caf√©", "Th√©"] },
                    { q: "Apple", a: "Pomme", wrong: ["Orange", "Banane", "Poire"] },
                    { q: "Coffee", a: "Caf√©", wrong: ["Th√©", "Chocolat", "Lait"] },
                    { q: "Wine", a: "Vin", wrong: ["Bi√®re", "Eau", "Jus"] },
                    { q: "Croissant", a: "Croissant", wrong: ["Baguette", "Pain", "Brioche"] },
                    { q: "Egg", a: "≈íuf", wrong: ["Fromage", "Beurre", "Lait"] },
                    { q: "Chicken", a: "Poulet", wrong: ["B≈ìuf", "Porc", "Poisson"] }
                ]
            },
            family: {
                name: 'Family Members',
                icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
                category: 'family',
                author: 'Cuizzy',
                plays: 650,
                questions: [
                    { q: "Mother", a: "M√®re", wrong: ["P√®re", "S≈ìur", "Tante"] },
                    { q: "Father", a: "P√®re", wrong: ["M√®re", "Fr√®re", "Oncle"] },
                    { q: "Brother", a: "Fr√®re", wrong: ["S≈ìur", "P√®re", "Cousin"] },
                    { q: "Sister", a: "S≈ìur", wrong: ["Fr√®re", "M√®re", "Cousine"] },
                    { q: "Grandmother", a: "Grand-m√®re", wrong: ["Grand-p√®re", "M√®re", "Tante"] },
                    { q: "Grandfather", a: "Grand-p√®re", wrong: ["Grand-m√®re", "P√®re", "Oncle"] },
                    { q: "Aunt", a: "Tante", wrong: ["Oncle", "M√®re", "Cousine"] },
                    { q: "Uncle", a: "Oncle", wrong: ["Tante", "P√®re", "Cousin"] },
                    { q: "Son", a: "Fils", wrong: ["Fille", "Fr√®re", "Neveu"] },
                    { q: "Daughter", a: "Fille", wrong: ["Fils", "S≈ìur", "Ni√®ce"] }
                ]
            }
        };

        // User-created sets
        let customSets = [];
        let newSetQuestions = [];
        let selectedSetEmoji = 'üìö';

        // Game state
        let currentSet = null;
        let currentSetName = '';
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let correctCount = 0;
        let gameMode = 'gold-quest';
        let selectedCategory = 'all';

        // ==================== UTILITY FUNCTIONS ====================
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // ==================== MODAL FUNCTIONS ====================
        function openModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            // Reset form states
            if (id === 'soloModal') {
                document.querySelectorAll('#soloSetGrid .set-select-card').forEach(c => c.classList.remove('selected'));
                document.getElementById('startSoloBtn').disabled = true;
                currentSet = null;
            }
            if (id === 'createSetModal') {
                resetCreateSetForm();
            }
        }

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', e => {
                if (e.target === modal) closeModal(modal.id);
            });
        });

        // ==================== AUTHENTICATION ====================
        function openAuthModal(tab) {
            openModal('authModal');
            switchAuthTab(tab);
        }

        function switchAuthTab(tab) {
            document.getElementById('loginTab').classList.toggle('active', tab === 'login');
            document.getElementById('signupTab').classList.toggle('active', tab === 'signup');
            document.getElementById('loginContent').classList.toggle('active', tab === 'login');
            document.getElementById('signupContent').classList.toggle('active', tab === 'signup');
        }

        function checkPasswordStrength() {
            const password = document.getElementById('signupPassword').value;
            const strengthBar = document.getElementById('passwordStrength');

            strengthBar.className = 'password-strength-fill';
            if (password.length === 0) {
                strengthBar.style.width = '0';
            } else if (password.length < 6) {
                strengthBar.classList.add('weak');
            } else if (password.length < 10 || !/[A-Z]/.test(password) || !/[0-9]/.test(password)) {
                strengthBar.classList.add('medium');
            } else {
                strengthBar.classList.add('strong');
            }
        }

        function validateSignupForm() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirm = document.getElementById('signupConfirmPassword').value;

            const isValid = username.length >= 3 &&
                           email.includes('@') &&
                           password.length >= 6 &&
                           password === confirm;

            document.getElementById('signupBtn').disabled = !isValid;
        }

        function handleSignup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;

            // Check if user exists
            const existingUser = userStore.users.find(u => u.email === email || u.username === username);
            if (existingUser) {
                showToast('Username or email already exists!');
                return;
            }

            // Create new user
            const newUser = {
                id: Date.now(),
                username,
                email,
                password, // In real app, this would be hashed
                points: 0,
                gamesPlayed: 0,
                setsCreated: 0,
                createdAt: new Date().toISOString()
            };

            userStore.users.push(newUser);
            userStore.currentUser = newUser;

            closeModal('authModal');
            updateAuthUI();
            showToast(`Welcome to Cuizzy, ${username}! üéâ`);

            // Clear form
            document.getElementById('signupUsername').value = '';
            document.getElementById('signupEmail').value = '';
            document.getElementById('signupPassword').value = '';
            document.getElementById('signupConfirmPassword').value = '';
        }

        function handleLogin() {
            const emailOrUsername = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            const user = userStore.users.find(u =>
                (u.email === emailOrUsername || u.username === emailOrUsername) &&
                u.password === password
            );

            if (user) {
                userStore.currentUser = user;
                closeModal('authModal');
                updateAuthUI();
                showToast(`Welcome back, ${user.username}! üéâ`);

                // Clear form
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
            } else {
                showToast('Invalid email/username or password');
            }
        }

        function handleLogout() {
            userStore.currentUser = null;
            closeModal('profileModal');
            updateAuthUI();
            showToast('Logged out successfully');
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('authButtons');
            const userProfileBtn = document.getElementById('userProfileBtn');
            const mySetsSection = document.getElementById('mySetsSection');

            if (userStore.currentUser) {
                authButtons.style.display = 'none';
                userProfileBtn.style.display = 'flex';
                mySetsSection.style.display = 'block';

                const initial = userStore.currentUser.username.charAt(0).toUpperCase();
                document.getElementById('userAvatarNav').textContent = initial;
                document.getElementById('userNameNav').textContent = userStore.currentUser.username;
                document.getElementById('userPointsNav').textContent = userStore.currentUser.points;

                renderMySets();
            } else {
                authButtons.style.display = 'block';
                userProfileBtn.style.display = 'none';
                mySetsSection.style.display = 'none';
            }
        }

        function openProfileModal() {
            if (!userStore.currentUser) return;

            const user = userStore.currentUser;
            document.getElementById('profileAvatar').textContent = user.username.charAt(0).toUpperCase();
            document.getElementById('profileName').textContent = user.username;
            document.getElementById('profileEmail').textContent = user.email;
            document.getElementById('profilePoints').textContent = user.points;
            document.getElementById('profileGames').textContent = user.gamesPlayed;
            document.getElementById('profileSets').textContent = user.setsCreated;

            openModal('profileModal');
        }

        // ==================== NAVIGATION ====================
        function goHome() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('discoverPage').classList.remove('active');
            document.getElementById('mainFooter').style.display = 'block';
            document.getElementById('gameOver').classList.remove('active');
            document.getElementById('gameContainer').classList.remove('active');
            document.body.style.overflow = '';
        }

        function showDiscover() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('discoverPage').classList.add('active');
            document.getElementById('mainFooter').style.display = 'none';
            renderDiscoverSets();
        }

        // ==================== DISCOVER PAGE ====================
        function renderDiscoverSets() {
            const grid = document.getElementById('discoverGrid');
            const searchQuery = document.getElementById('discoverSearch').value.toLowerCase();

            // Combine built-in and custom sets
            let allSets = [];

            // Add built-in sets
            Object.entries(builtInSets).forEach(([id, set]) => {
                allSets.push({ id, ...set, isBuiltIn: true });
            });

            // Add custom sets
            customSets.forEach(set => {
                allSets.push({ ...set, isBuiltIn: false });
            });

            // Filter by category
            if (selectedCategory !== 'all') {
                if (selectedCategory === 'custom') {
                    allSets = allSets.filter(s => !s.isBuiltIn);
                } else {
                    allSets = allSets.filter(s => s.category === selectedCategory);
                }
            }

            // Filter by search
            if (searchQuery) {
                allSets = allSets.filter(s =>
                    s.name.toLowerCase().includes(searchQuery) ||
                    s.category.toLowerCase().includes(searchQuery)
                );
            }

            if (allSets.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <i class="fas fa-search"></i>
                        <h3>No sets found</h3>
                        <p>Try a different search or category</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = allSets.map(set => `
                <div class="discover-card" onclick="playDiscoverSet('${set.id}', ${!set.isBuiltIn})">
                    <div class="discover-card-header">
                        <div class="discover-card-icon" style="background: linear-gradient(135deg, ${getCategoryColor(set.category)});">
                            ${set.icon}
                        </div>
                        <div class="discover-card-info">
                            <h3>${set.name}</h3>
                            <div class="author">by ${set.author || 'Anonymous'}</div>
                            <div class="description">${set.questions.length} questions ‚Ä¢ ${set.category}</div>
                        </div>
                    </div>
                    <div class="discover-card-footer">
                        <div class="discover-card-stats">
                            <span><i class="fas fa-play"></i> ${set.plays || 0}</span>
                            <span><i class="fas fa-question-circle"></i> ${set.questions.length}</span>
                        </div>
                        ${set.isBuiltIn ? '<span class="discover-card-badge popular">Official</span>' : '<span class="discover-card-badge user">Community</span>'}
                    </div>
                </div>
            `).join('');
        }

        function getCategoryColor(category) {
            const colors = {
                greetings: '#2196f3, #1976d2',
                numbers: '#4caf50, #388e3c',
                colors: '#ff9800, #f57c00',
                animals: '#e91e63, #c2185b',
                food: '#00bcd4, #0097a7',
                family: '#9c27b0, #7b1fa2',
                custom: '#607d8b, #455a64'
            };
            return colors[category] || colors.custom;
        }

        function filterByCategory(btn, category) {
            selectedCategory = category;
            document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            renderDiscoverSets();
        }

        function filterDiscoverSets() {
            renderDiscoverSets();
        }

        function playDiscoverSet(setId, isCustom) {
            if (isCustom) {
                const set = customSets.find(s => s.id === setId);
                if (set) {
                    currentQuestions = [...set.questions];
                    currentSet = setId;
                }
            } else {
                currentQuestions = [...builtInSets[setId].questions];
                currentSet = setId;
            }
            goHome();
            startGame(setId, 'gold-quest', isCustom);
        }

        // ==================== QUESTION SETS RENDERING ====================
        function renderQuestionSets() {
            const grid = document.getElementById('questionSetsGrid');
            grid.innerHTML = Object.entries(builtInSets).map(([id, set]) => `
                <div class="set-card" onclick="startSoloGame('${id}')">
                    <div class="set-icon ${id}">${set.icon}</div>
                    <div class="set-info">
                        <h3>${set.name}</h3>
                        <p>${set.questions[0].q} ‚Üí ${set.questions[0].a}...</p>
                        <div class="set-meta">
                            <span><i class="fas fa-question-circle"></i> ${set.questions.length} Qs</span>
                            <span><i class="fas fa-play"></i> ${set.plays}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderSoloModal() {
            const grid = document.getElementById('soloSetGrid');
            let html = '';

            // Built-in sets
            Object.entries(builtInSets).forEach(([id, set]) => {
                html += `
                    <div class="set-select-card" onclick="selectSoloSet(this, '${id}', false)">
                        <div class="set-select-icon" style="background: linear-gradient(135deg, ${getCategoryColor(set.category)});">${set.icon}</div>
                        <div class="set-select-info"><h4>${set.name}</h4><p>${set.questions.length} Questions</p></div>
                    </div>
                `;
            });

            // Custom sets
            customSets.forEach(set => {
                html += `
                    <div class="set-select-card" onclick="selectSoloSet(this, '${set.id}', true)">
                        <div class="set-select-icon" style="background: linear-gradient(135deg, ${getCategoryColor(set.category)});">${set.icon}</div>
                        <div class="set-select-info"><h4>${set.name}</h4><p>${set.questions.length} Questions (Custom)</p></div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function renderMySets() {
            const grid = document.getElementById('mySetsGrid');
            const userSets = customSets.filter(s => s.authorId === (userStore.currentUser?.id || 0));

            if (userSets.length === 0) {
                grid.innerHTML = `
                    <div class="my-sets-empty" style="grid-column: 1/-1;">
                        <i class="fas fa-folder-open"></i>
                        <h3>No sets yet</h3>
                        <p>Create your first question set to see it here!</p>
                        <button class="btn-primary btn-pink" onclick="openCreateSetModal()" style="width: auto; margin-top: 10px;">
                            <i class="fas fa-plus"></i> Create Set
                        </button>
                    </div>
                `;
                return;
            }

            grid.innerHTML = userSets.map(set => `
                <div class="set-card" onclick="startSoloGame('${set.id}', true)">
                    <div class="set-icon" style="background: linear-gradient(135deg, ${getCategoryColor(set.category)});">${set.icon}</div>
                    <div class="set-info">
                        <h3>${set.name}</h3>
                        <p>${set.questions.length} questions</p>
                        <div class="set-meta">
                            <span><i class="fas fa-play"></i> ${set.plays || 0}</span>
                            <span><i class="fas fa-user"></i> My Set</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ==================== CREATE SET ====================
        function openCreateSetModal() {
            if (!userStore.currentUser) {
                showToast('Please log in to create sets');
                openAuthModal('signup');
                return;
            }
            resetCreateSetForm();
            openModal('createSetModal');
        }

        function resetCreateSetForm() {
            newSetQuestions = [];
            selectedSetEmoji = 'üìö';
            document.getElementById('setName').value = '';
            document.getElementById('setCategory').value = 'greetings';
            document.getElementById('newQuestionText').value = '';
            document.getElementById('newCorrectAnswer').value = '';
            document.getElementById('wrongAnswer1').value = '';
            document.getElementById('wrongAnswer2').value = '';
            document.getElementById('wrongAnswer3').value = '';
            document.querySelectorAll('.emoji-option').forEach(e => e.classList.remove('selected'));
            document.querySelector('.emoji-option').classList.add('selected');
            updateQuestionsListUI();
        }

        function selectEmoji(btn, emoji) {
            document.querySelectorAll('.emoji-option').forEach(e => e.classList.remove('selected'));
            btn.classList.add('selected');
            selectedSetEmoji = emoji;
        }

        function addQuestionToSet() {
            const questionText = document.getElementById('newQuestionText').value.trim();
            const correctAnswer = document.getElementById('newCorrectAnswer').value.trim();
            const wrong1 = document.getElementById('wrongAnswer1').value.trim();
            const wrong2 = document.getElementById('wrongAnswer2').value.trim();
            const wrong3 = document.getElementById('wrongAnswer3').value.trim();

            if (!questionText || !correctAnswer || !wrong1 || !wrong2 || !wrong3) {
                showToast('Please fill in all fields');
                return;
            }

            if (newSetQuestions.length >= 20) {
                showToast('Maximum 20 questions per set');
                return;
            }

            newSetQuestions.push({
                q: questionText,
                a: correctAnswer,
                wrong: [wrong1, wrong2, wrong3]
            });

            // Clear inputs
            document.getElementById('newQuestionText').value = '';
            document.getElementById('newCorrectAnswer').value = '';
            document.getElementById('wrongAnswer1').value = '';
            document.getElementById('wrongAnswer2').value = '';
            document.getElementById('wrongAnswer3').value = '';

            updateQuestionsListUI();
            showToast('Question added!');
        }

        function removeQuestion(index) {
            newSetQuestions.splice(index, 1);
            updateQuestionsListUI();
        }

        function updateQuestionsListUI() {
            const list = document.getElementById('questionsList');
            const count = document.getElementById('questionCount');
            const saveBtn = document.getElementById('saveSetBtn');

            count.textContent = newSetQuestions.length;
            saveBtn.disabled = newSetQuestions.length < 4;

            if (newSetQuestions.length === 0) {
                list.innerHTML = `
                    <div class="empty-state" style="padding: 30px;">
                        <i class="fas fa-clipboard-list"></i>
                        <p style="margin-bottom: 0;">No questions added yet. Add your first question below!</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = newSetQuestions.map((q, i) => `
                <div class="question-item">
                    <div class="question-item-header">
                        <span class="question-item-number">Q${i + 1}</span>
                        <button class="question-item-delete" onclick="removeQuestion(${i})"><i class="fas fa-trash"></i></button>
                    </div>
                    <div class="question-item-content">
                        <strong>${q.q}</strong> ‚Üí ${q.a}
                    </div>
                </div>
            `).join('');
        }

        function saveQuestionSet() {
            const name = document.getElementById('setName').value.trim();
            const category = document.getElementById('setCategory').value;

            if (!name) {
                showToast('Please enter a set name');
                return;
            }

            if (newSetQuestions.length < 4) {
                showToast('Add at least 4 questions');
                return;
            }

            const newSet = {
                id: 'custom_' + Date.now(),
                name,
                icon: selectedSetEmoji,
                category,
                author: userStore.currentUser.username,
                authorId: userStore.currentUser.id,
                plays: 0,
                questions: [...newSetQuestions],
                createdAt: new Date().toISOString()
            };

            customSets.push(newSet);
            userStore.currentUser.setsCreated++;

            closeModal('createSetModal');
            renderMySets();
            renderSoloModal();
            showToast('Set created successfully! üéâ');
        }

        // ==================== GAME LOGIC ====================
        function openJoinModal() {
            openModal('joinModal');
            document.getElementById('gameIdInput').focus();
        }

        function openSoloModal() {
            renderSoloModal();
            openModal('soloModal');
        }

        document.getElementById('gameIdInput').addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        function submitGameId() {
            const gameId = document.getElementById('gameIdInput').value;
            if (gameId.length === 6) {
                showToast('Joining game ' + gameId + '...');
                closeModal('joinModal');
                document.getElementById('gameIdInput').value = '';
            } else {
                showToast('Please enter a valid 6-digit Game ID');
            }
        }

        let selectedSoloSetIsCustom = false;

        function selectSoloSet(card, setId, isCustom) {
            document.querySelectorAll('#soloSetGrid .set-select-card').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            currentSet = setId;
            selectedSoloSetIsCustom = isCustom;
            document.getElementById('startSoloBtn').disabled = false;
        }

        function startSoloFromModal() {
            if (!currentSet) {
                showToast('Please select a topic first');
                return;
            }
            closeModal('soloModal');
            startGame(currentSet, 'gold-quest', selectedSoloSetIsCustom);
        }

        function startSoloGame(setId, isCustom = false) {
            currentSet = setId;
            startGame(setId, 'gold-quest', isCustom);
        }

        function startGame(setId, mode, isCustom = false) {
            gameMode = mode;

            if (isCustom) {
                const set = customSets.find(s => s.id === setId);
                if (set) {
                    currentQuestions = shuffleArray([...set.questions]);
                    set.plays = (set.plays || 0) + 1;
                }
            } else {
                currentQuestions = shuffleArray([...builtInSets[setId].questions]);
            }

            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            correctCount = 0;

            const container = document.getElementById('gameContainer');
            container.className = 'game-container active ' + mode;
            document.body.style.overflow = 'hidden';

            updateGameUI();
            showQuestion();
        }

        function showQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            document.getElementById('questionNumber').textContent = `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            document.getElementById('questionText').textContent = `What is "${question.q}" in French?`;
            document.getElementById('progressFill').style.width = `${(currentQuestionIndex / currentQuestions.length) * 100}%`;

            const answers = shuffleArray([question.a, ...question.wrong]);
            const grid = document.getElementById('answersGrid');
            grid.innerHTML = answers.map(ans => `
                <button class="answer-btn" onclick="checkAnswer(this, '${escapeHtml(ans)}', '${escapeHtml(question.a)}')">
                    <span class="answer-color"></span>${ans}
                </button>
            `).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/'/g, "\\'");
        }

        function checkAnswer(btn, selected, correct) {
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(b => b.classList.add('disabled'));

            if (selected === correct) {
                btn.classList.add('correct');
                streak++;
                correctCount++;
                const points = 100 + (streak * 25);
                score += points;

                if (streak >= 3 && streak % 3 === 0) {
                    showStreakPopup(streak);
                }

                showToast(`+${points} points! üéâ`);
            } else {
                btn.classList.add('incorrect');
                streak = 0;
                buttons.forEach(b => {
                    if (b.textContent.trim() === correct) {
                        b.classList.add('show-correct');
                    }
                });
                showToast(`Correct answer: ${correct}`);
            }

            updateGameUI();

            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < currentQuestions.length) {
                    showQuestion();
                } else {
                    endGame();
                }
            }, 1500);
        }

        function updateGameUI() {
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('streakDisplay').textContent = streak;
            document.getElementById('correctDisplay').textContent = `${correctCount}/${currentQuestions.length}`;
        }

        function showStreakPopup(streakNum) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = `üî• ${streakNum} Streak!`;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 1500);
        }

        function endGame() {
            document.getElementById('gameContainer').classList.remove('active');
            document.getElementById('progressFill').style.width = '100%';

            // Update user stats
            if (userStore.currentUser) {
                userStore.currentUser.points += score;
                userStore.currentUser.gamesPlayed++;
                document.getElementById('userPointsNav').textContent = userStore.currentUser.points;
            }

            const percentage = (correctCount / currentQuestions.length) * 100;
            let icon = 'üèÜ';
            let title = 'Fantastique!';

            if (percentage < 50) { icon = 'üìö'; title = 'Keep Practicing!'; }
            else if (percentage < 70) { icon = 'üëç'; title = 'Bon Travail!'; }
            else if (percentage < 90) { icon = 'üåü'; title = 'Tr√®s Bien!'; }

            document.getElementById('gameOverIcon').textContent = icon;
            document.querySelector('.game-over-title').textContent = title;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOverDetail').textContent = `You got ${correctCount}/${currentQuestions.length} correct!`;

            document.getElementById('gameOver').classList.add('active');
        }

        function exitGame() {
            document.getElementById('gameContainer').classList.remove('active');
            document.body.style.overflow = '';
        }

        function playAgain() {
            document.getElementById('gameOver').classList.remove('active');
            const isCustom = currentSet && currentSet.startsWith('custom_');
            startGame(currentSet || 'greetings', gameMode, isCustom);
        }

        // ==================== INITIALIZATION ====================
        function init() {
            renderQuestionSets();
            renderSoloModal();
            updateAuthUI();
        }

        init();
    </script>
</body>
</html>
